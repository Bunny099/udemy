generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
}

enum ROLE {
  Student
  Instructor
}

model User {
  id                 String       @id @default(uuid())
  name               String
  email              String       @unique
  password           String
  role               ROLE         @default(Instructor)
  createdAt          DateTime     @default(now())
  updatedAt          DateTime     @updatedAt
  progress           Progress[]
  enrollment         Enrollment[]
  instructor_courses Course[]
}

enum COURSE_STATUS {
  Publish
  Draft
}

model Course {
  id            String        @id @default(uuid())
  name          String
  course_status COURSE_STATUS @default(Draft)
  instructorId  String
  instructor    User          @relation(fields: [instructorId], references: [id])
  lesson        Lesson[]
  enrollment    Enrollment[]
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
}

model Lesson {
  id        String     @id @default(uuid())
  content   String
  courseId  String
  course    Course     @relation(fields: [courseId], references: [id])
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  progress  Progress[]
}

model Enrollment {
  id        String   @id @default(uuid())
  studentId String
  student   User     @relation(fields: [studentId], references: [id])
  courseId  String
  course    Course   @relation(fields: [courseId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@unique([studentId, courseId])
}

enum PROGRESS_STATUS {
  COMPLETED
}

model Progress {
  status    PROGRESS_STATUS 
  lessonId  String
  lesson    Lesson          @relation(fields: [lessonId], references: [id])
  studentId String
  student   User            @relation(fields: [studentId], references: [id])
  createdAt DateTime        @default(now())
  updatedAt DateTime        @updatedAt

  @@id(name: "ProgressId", [lessonId, studentId])
}
